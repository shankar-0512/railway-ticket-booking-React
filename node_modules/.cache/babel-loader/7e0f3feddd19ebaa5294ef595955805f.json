{"ast":null,"code":"import _asyncToGenerator from\"D:/React JS/space-ticket-booking-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/React JS/space-ticket-booking-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\React JS\\\\space-ticket-booking-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useReducer,useRef,useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{Outlet}from\"react-router-dom\";import{loginActions}from\"../../store/login-slice\";import Card from\"../UI/Card/Card\";import Button from\"../UI/Button/Button\";import Input from\"../CommonInput/Input\";import styles from\"../CommonInput/Input.module.css\";import classes from\"./Login.module.css\";import useHttp from\"../../hooks/use-http\";import{useNavigate}from\"react-router-dom\";import LoadingSpinner from\"../UI/LoadingSpinner\";import Modal from\"../UI/Modal\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var currentPassword=\"\";//************REDUCERS************//\nfunction emailReducer(state,action){if(action.type===\"USER_INPUT\"){return{value:action.val,isValid:action.val.includes(\"@\")};}if(action.type===\"INPUT_BLUR\"){return{value:state.value,isValid:state.value.includes(\"@\")};}if(action.type===\"CLEAR\"){return{value:\"\",isValid:null};}return{value:\"\",isValid:false};}function passwordReducer(state,action){if(action.type===\"USER_INPUT\"){return{value:action.val,isValid:action.val.trim().length>6};}if(action.type===\"INPUT_BLUR\"){return{value:state.value,isValid:state.value.trim().length>6};}if(action.type===\"CLEAR\"){return{value:\"\",isValid:null};}return{value:\"\",isValid:false};}function nameReducer(state,action){if(action.type===\"USER_INPUT\"){return{value:action.val,isValid:action.val.trim().length!==\"\"};}if(action.type===\"INPUT_BLUR\"){return{value:state.value,isValid:state.value.trim().length!==\"\"};}if(action.type===\"CLEAR\"){return{value:\"\",isValid:null};}return{value:\"\",isValid:false};}function rePasswordReducer(state,action){if(action.type===\"USER_INPUT\"){return{value:action.val,isValid:action.val.trim()===currentPassword.trim()};}if(action.type===\"INPUT_BLUR\"){return{value:state.value,isValid:state.value.trim()===currentPassword.trim()};}if(action.type===\"CLEAR\"){return{value:\"\",isValid:null};}return{value:\"\",isValid:false};}function planetReducer(state,action){if(action.type===\"USER_INPUT\"){return{value:action.val,isValid:action.val.trim()!==\"\"};}if(action.type===\"INPUT_BLUR\"){return{value:state.value,isValid:state.value.trim()!==\"\"};}if(action.type===\"CLEAR\"){return{value:\"\",isValid:null};}return{value:\"\",isValid:false};}function dateReducer(state,action){if(action.type===\"USER_INPUT\"){return{value:action.val,isValid:action.val.trim()!==\"\"};}if(action.type===\"INPUT_BLUR\"){return{value:state.value,isValid:state.value.trim()!==\"\"};}if(action.type===\"CLEAR\"){return{value:\"\",isValid:null};}return{value:\"\",isValid:false};}function Login(props){//************DECLARATIONS************//\nvar navigate=useNavigate();var dispatch=useDispatch();//STATES\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),formIsValid=_useState2[0],setFormIsValid=_useState2[1];var _useReducer=useReducer(emailReducer,{value:\"\",isValid:null}),_useReducer2=_slicedToArray(_useReducer,2),emailState=_useReducer2[0],dispatchEmail=_useReducer2[1];var _useReducer3=useReducer(nameReducer,{value:\"\",isValid:null}),_useReducer4=_slicedToArray(_useReducer3,2),nameState=_useReducer4[0],dispatchName=_useReducer4[1];var _useReducer5=useReducer(passwordReducer,{value:\"\",isValid:null}),_useReducer6=_slicedToArray(_useReducer5,2),passwordState=_useReducer6[0],dispatchPassword=_useReducer6[1];var _useReducer7=useReducer(rePasswordReducer,{value:\"\",isValid:null}),_useReducer8=_slicedToArray(_useReducer7,2),rePasswordState=_useReducer8[0],dispatchRePassword=_useReducer8[1];var _useReducer9=useReducer(planetReducer,{value:\"\",isValid:null}),_useReducer10=_slicedToArray(_useReducer9,2),planetState=_useReducer10[0],dispatchPlanet=_useReducer10[1];var _useReducer11=useReducer(dateReducer,{value:\"\",isValid:null}),_useReducer12=_slicedToArray(_useReducer11,2),dateState=_useReducer12[0],dispatchDate=_useReducer12[1];//REFS\nvar nameInputRef=useRef();var emailInputRef=useRef();var passwordInputRef=useRef();var rePasswordInputRef=useRef();var planetInputRef=useRef();var dateInputRef=useRef();var _useHttp=useHttp(),isLoading=_useHttp.isLoading,error=_useHttp.error,sendTaskRequest=_useHttp.sendRequest,response=_useHttp.response,resetError=_useHttp.resetError,resetResponse=_useHttp.resetResponse;//checking for form validity every 500ms\nuseEffect(function(){var identifier=setTimeout(function(){if(props.signUpFlag){setFormIsValid(nameState.isValid&&emailState.isValid&&passwordState.isValid&&rePasswordState.isValid&&planetState.isValid&&dateState.isValid);}else{setFormIsValid(emailState.isValid&&passwordState.isValid);}},200);return function clearTimer(){clearTimeout(identifier);};},//use effect dependencies - will re run every time below dependencies change.\n//Therefore useffect is guaranteed to use the latest state.\n[nameState.isValid,emailState.isValid,passwordState.isValid,rePasswordState.isValid,planetState.isValid,dateState.isValid,props.signUpFlag,formIsValid]);//************API CALLS************//\n//Request to backend for login and sign-up\nvar SignUpRequestHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(requestJson){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:sendTaskRequest({url:\"http://localhost:8080/api/protected/loginAuth\",method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:{name:requestJson.enteredName,email:requestJson.enteredEmail,password:requestJson.enteredPassword,rePassword:requestJson.enteredRePassword,basePlanet:requestJson.enteredPlanet,dob:requestJson.enteredDate,signUpF:requestJson.signUpFlag},errorMsg:\"Request failed!\"});case 1:case\"end\":return _context.stop();}}},_callee);}));return function SignUpRequestHandler(_x){return _ref.apply(this,arguments);};}();//************STATE HANDLERS************//\nfunction nameChangeHandler(event){dispatchName({type:\"USER_INPUT\",val:event.target.value});}function validateNameHandler(){dispatchName({type:\"INPUT_BLUR\"});}function emailChangeHandler(event){dispatchEmail({type:\"USER_INPUT\",val:event.target.value});}function validateEmailHandler(){dispatchEmail({type:\"INPUT_BLUR\"});}function passwordChangeHandler(event){dispatchPassword({type:\"USER_INPUT\",val:event.target.value});currentPassword=event.target.value;}function validatePasswordHandler(){dispatchPassword({type:\"INPUT_BLUR\"});}function rePasswordChangeHandler(event){dispatchRePassword({type:\"USER_INPUT\",val:event.target.value});}function validateRePasswordHandler(){dispatchRePassword({type:\"INPUT_BLUR\"});}function planetChangeHandler(event){dispatchPlanet({type:\"USER_INPUT\",val:event.target.value});}function validatePlanetHandler(){dispatchPlanet({type:\"INPUT_BLUR\"});}function dateChangeHandler(event){dispatchDate({type:\"USER_INPUT\",val:event.target.value});}function validateDateHandler(){dispatchDate({type:\"INPUT_BLUR\"});}//************ACTION HANDLERS************//\nfunction submitHandler(event){event.preventDefault();if(props.signUpFlag){var enteredName=nameState.value;var enteredEmail=emailState.value;var enteredPassword=passwordState.value;var enteredRePassword=rePasswordState.value;var enteredPlanet=planetState.value;var enteredDate=dateState.value;if(formIsValid){var requestJson={enteredName:enteredName,enteredEmail:enteredEmail,enteredPassword:enteredPassword,enteredRePassword:enteredRePassword,enteredPlanet:enteredPlanet,enteredDate:enteredDate,signUpFlag:\"Y\"};SignUpRequestHandler(requestJson);setFormIsValid(false);props.postSignUp();dispatchName({type:\"CLEAR\"});dispatchEmail({type:\"CLEAR\"});dispatchPassword({type:\"CLEAR\"});dispatchRePassword({type:\"CLEAR\"});dispatchPlanet({type:\"CLEAR\"});dispatchDate({type:\"CLEAR\"});}}else{var _enteredEmail=emailState.value;var _enteredPassword=passwordState.value;if(formIsValid){var _requestJson={enteredEmail:_enteredEmail,enteredPassword:_enteredPassword,signUpFlag:\"N\"};SignUpRequestHandler(_requestJson);setFormIsValid(false);dispatchEmail({type:\"CLEAR\"});dispatchPassword({type:\"CLEAR\"});}}}function closeErrorModal(){resetError();resetResponse();}if(response.responseCode===0){dispatch(loginActions.LoginStateHandler());dispatch(loginActions.UpdateUserId(response.userId));localStorage.setItem(\"isLoggedIn\",1);localStorage.setItem(\"userId\",response.userId);closeErrorModal();}useEffect(function(){if(props.loginF){navigate(\"/login\");}},[props.loginF,navigate]);//************MODALS************//\nvar modalActions=/*#__PURE__*/_jsx(\"div\",{className:classes.actions,children:/*#__PURE__*/_jsx(Button,{className:classes.btn,onClick:closeErrorModal,children:\"Close\"})});var loginModalContent=/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:classes.total,children:/*#__PURE__*/_jsx(\"span\",{children:response.responseMessage})})});//************LOADING SPINNERS************//\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"centered\",children:/*#__PURE__*/_jsx(LoadingSpinner,{})});}return/*#__PURE__*/_jsxs(Card,{className:classes.login,children:[(error||response.responseCode!==undefined)&&/*#__PURE__*/_jsxs(Modal,{onClose:props.onClose,children:[loginModalContent,modalActions]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,children:[props.signUpFlag&&/*#__PURE__*/_jsx(Input,{ref:nameInputRef,id:\"name\",label:\"Name\",type:\"text\",isValid:nameState.isValid,value:nameState.value,onChange:nameChangeHandler,onBlur:validateNameHandler}),/*#__PURE__*/_jsx(Input,{ref:emailInputRef,id:\"email\",label:\"E-Mail\",type:\"email\",isValid:emailState.isValid,value:emailState.value,onChange:emailChangeHandler,onBlur:validateEmailHandler}),/*#__PURE__*/_jsx(Input,{ref:passwordInputRef,id:\"password\",label:\"Password\",type:\"password\",isValid:passwordState.isValid,value:passwordState.value,onChange:passwordChangeHandler,onBlur:validatePasswordHandler}),props.signUpFlag&&/*#__PURE__*/_jsx(Input,{ref:rePasswordInputRef,id:\"rePassword\",label:\"Re-Password\",type:\"password\",isValid:rePasswordState.isValid,value:rePasswordState.value,onChange:rePasswordChangeHandler,onBlur:validateRePasswordHandler}),props.signUpFlag&&/*#__PURE__*/_jsxs(\"div\",{className:styles.control,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Base Planet\"}),/*#__PURE__*/_jsxs(\"select\",{ref:planetInputRef,className:classes.select,name:\"planetList\",id:\"planets\",value:planetState.value,onChange:planetChangeHandler,onBlur:validatePlanetHandler,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",style:{color:\"grey\"},children:\"Select an Option\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Earth\",style:{color:\"black\"},children:\"Earth\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Mars\",style:{color:\"black\"},children:\"Mars\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Moon\",style:{color:\"black\"},children:\"Moon\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Ceres\",style:{color:\"black\"},children:\"Ceres\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Europa\",style:{color:\"black\"},children:\"Europa\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Titan\",style:{color:\"black\"},children:\"Titan\"}),/*#__PURE__*/_jsx(\"option\",{value:\"EB-15\",style:{color:\"black\"},children:\"EB-15\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ISS\",style:{color:\"black\"},children:\"ISS\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Kepler-186F\",style:{color:\"black\"},children:\"Kepler-186F\"})]})]}),props.signUpFlag&&/*#__PURE__*/_jsxs(\"div\",{className:styles.control,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",children:\"Date of Birth\"}),/*#__PURE__*/_jsx(\"input\",{ref:dateInputRef,id:\"date\",label:\"Journey Date\",type:\"date\",isValid:dateState.isValid,value:dateState.value,onChange:dateChangeHandler,onBlur:validateDateHandler,max:moment().format(\"YYYY-MM-DD\")})]}),!props.signUpFlag&&/*#__PURE__*/_jsxs(\"div\",{className:classes.action,children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",className:classes.btn,children:\"Sign in\"}),/*#__PURE__*/_jsx(Outlet,{})]}),props.signUpFlag&&/*#__PURE__*/_jsxs(\"div\",{className:classes.action,children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",className:classes.btn,children:\"Sign up\"}),/*#__PURE__*/_jsx(Outlet,{})]})]})]});}export default Login;","map":{"version":3,"sources":["D:/React JS/space-ticket-booking-app/src/components/Authentication/Login.js"],"names":["React","useReducer","useRef","useEffect","useState","useDispatch","Outlet","loginActions","Card","Button","Input","styles","classes","useHttp","useNavigate","LoadingSpinner","Modal","moment","currentPassword","emailReducer","state","action","type","value","val","isValid","includes","passwordReducer","trim","length","nameReducer","rePasswordReducer","planetReducer","dateReducer","Login","props","navigate","dispatch","formIsValid","setFormIsValid","emailState","dispatchEmail","nameState","dispatchName","passwordState","dispatchPassword","rePasswordState","dispatchRePassword","planetState","dispatchPlanet","dateState","dispatchDate","nameInputRef","emailInputRef","passwordInputRef","rePasswordInputRef","planetInputRef","dateInputRef","isLoading","error","sendTaskRequest","sendRequest","response","resetError","resetResponse","identifier","setTimeout","signUpFlag","clearTimer","clearTimeout","SignUpRequestHandler","requestJson","url","method","headers","body","name","enteredName","email","enteredEmail","password","enteredPassword","rePassword","enteredRePassword","basePlanet","enteredPlanet","dob","enteredDate","signUpF","errorMsg","nameChangeHandler","event","target","validateNameHandler","emailChangeHandler","validateEmailHandler","passwordChangeHandler","validatePasswordHandler","rePasswordChangeHandler","validateRePasswordHandler","planetChangeHandler","validatePlanetHandler","dateChangeHandler","validateDateHandler","submitHandler","preventDefault","postSignUp","closeErrorModal","responseCode","LoginStateHandler","UpdateUserId","userId","localStorage","setItem","loginF","modalActions","actions","btn","loginModalContent","total","responseMessage","login","undefined","onClose","control","select","color","format"],"mappings":"wXAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,MAA5B,CAAoCC,SAApC,CAA+CC,QAA/C,KAA+D,OAA/D,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,MAAT,KAAuB,kBAAvB,CACA,OAASC,YAAT,KAA6B,yBAA7B,CACA,MAAOC,CAAAA,IAAP,KAAiB,iBAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,sBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,iCAAnB,CACA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,CACA,MAAOC,CAAAA,OAAP,KAAoB,sBAApB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,MAAOC,CAAAA,cAAP,KAA2B,sBAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,C,wFAEA,GAAIC,CAAAA,eAAe,CAAG,EAAtB,CAEA;AAEA,QAASC,CAAAA,YAAT,CAAsBC,KAAtB,CAA6BC,MAA7B,CAAqC,CACnC,GAAIA,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEF,MAAM,CAACG,GAAhB,CAAqBC,OAAO,CAAEJ,MAAM,CAACG,GAAP,CAAWE,QAAX,CAAoB,GAApB,CAA9B,CAAP,CACD,CACD,GAAIL,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEH,KAAK,CAACG,KAAf,CAAsBE,OAAO,CAAEL,KAAK,CAACG,KAAN,CAAYG,QAAZ,CAAqB,GAArB,CAA/B,CAAP,CACD,CACD,GAAIL,MAAM,CAACC,IAAP,GAAgB,OAApB,CAA6B,CAC3B,MAAO,CAAEC,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,IAAtB,CAAP,CACD,CAED,MAAO,CAAEF,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,KAAtB,CAAP,CACD,CAED,QAASE,CAAAA,eAAT,CAAyBP,KAAzB,CAAgCC,MAAhC,CAAwC,CACtC,GAAIA,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEF,MAAM,CAACG,GAAhB,CAAqBC,OAAO,CAAEJ,MAAM,CAACG,GAAP,CAAWI,IAAX,GAAkBC,MAAlB,CAA2B,CAAzD,CAAP,CACD,CACD,GAAIR,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEH,KAAK,CAACG,KAAf,CAAsBE,OAAO,CAAEL,KAAK,CAACG,KAAN,CAAYK,IAAZ,GAAmBC,MAAnB,CAA4B,CAA3D,CAAP,CACD,CACD,GAAIR,MAAM,CAACC,IAAP,GAAgB,OAApB,CAA6B,CAC3B,MAAO,CAAEC,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,IAAtB,CAAP,CACD,CAED,MAAO,CAAEF,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,KAAtB,CAAP,CACD,CAED,QAASK,CAAAA,WAAT,CAAqBV,KAArB,CAA4BC,MAA5B,CAAoC,CAClC,GAAIA,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEF,MAAM,CAACG,GAAhB,CAAqBC,OAAO,CAAEJ,MAAM,CAACG,GAAP,CAAWI,IAAX,GAAkBC,MAAlB,GAA6B,EAA3D,CAAP,CACD,CACD,GAAIR,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEH,KAAK,CAACG,KAAf,CAAsBE,OAAO,CAAEL,KAAK,CAACG,KAAN,CAAYK,IAAZ,GAAmBC,MAAnB,GAA8B,EAA7D,CAAP,CACD,CACD,GAAIR,MAAM,CAACC,IAAP,GAAgB,OAApB,CAA6B,CAC3B,MAAO,CAAEC,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,IAAtB,CAAP,CACD,CAED,MAAO,CAAEF,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,KAAtB,CAAP,CACD,CAED,QAASM,CAAAA,iBAAT,CAA2BX,KAA3B,CAAkCC,MAAlC,CAA0C,CACxC,GAAIA,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CACLC,KAAK,CAAEF,MAAM,CAACG,GADT,CAELC,OAAO,CAAEJ,MAAM,CAACG,GAAP,CAAWI,IAAX,KAAsBV,eAAe,CAACU,IAAhB,EAF1B,CAAP,CAID,CACD,GAAIP,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CACLC,KAAK,CAAEH,KAAK,CAACG,KADR,CAELE,OAAO,CAAEL,KAAK,CAACG,KAAN,CAAYK,IAAZ,KAAuBV,eAAe,CAACU,IAAhB,EAF3B,CAAP,CAID,CACD,GAAIP,MAAM,CAACC,IAAP,GAAgB,OAApB,CAA6B,CAC3B,MAAO,CAAEC,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,IAAtB,CAAP,CACD,CAED,MAAO,CAAEF,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,KAAtB,CAAP,CACD,CAED,QAASO,CAAAA,aAAT,CAAuBZ,KAAvB,CAA8BC,MAA9B,CAAsC,CACpC,GAAIA,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEF,MAAM,CAACG,GAAhB,CAAqBC,OAAO,CAAEJ,MAAM,CAACG,GAAP,CAAWI,IAAX,KAAsB,EAApD,CAAP,CACD,CACD,GAAIP,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CACLC,KAAK,CAAEH,KAAK,CAACG,KADR,CAELE,OAAO,CAAEL,KAAK,CAACG,KAAN,CAAYK,IAAZ,KAAuB,EAF3B,CAAP,CAID,CACD,GAAIP,MAAM,CAACC,IAAP,GAAgB,OAApB,CAA6B,CAC3B,MAAO,CAAEC,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,IAAtB,CAAP,CACD,CACD,MAAO,CAAEF,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,KAAtB,CAAP,CACD,CAED,QAASQ,CAAAA,WAAT,CAAqBb,KAArB,CAA4BC,MAA5B,CAAoC,CAClC,GAAIA,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CAAEC,KAAK,CAAEF,MAAM,CAACG,GAAhB,CAAqBC,OAAO,CAAEJ,MAAM,CAACG,GAAP,CAAWI,IAAX,KAAsB,EAApD,CAAP,CACD,CACD,GAAIP,MAAM,CAACC,IAAP,GAAgB,YAApB,CAAkC,CAChC,MAAO,CACLC,KAAK,CAAEH,KAAK,CAACG,KADR,CAELE,OAAO,CAAEL,KAAK,CAACG,KAAN,CAAYK,IAAZ,KAAuB,EAF3B,CAAP,CAID,CACD,GAAIP,MAAM,CAACC,IAAP,GAAgB,OAApB,CAA6B,CAC3B,MAAO,CAAEC,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,IAAtB,CAAP,CACD,CACD,MAAO,CAAEF,KAAK,CAAE,EAAT,CAAaE,OAAO,CAAE,KAAtB,CAAP,CACD,CAED,QAASS,CAAAA,KAAT,CAAeC,KAAf,CAAsB,CACpB;AAEA,GAAMC,CAAAA,QAAQ,CAAGtB,WAAW,EAA5B,CACA,GAAMuB,CAAAA,QAAQ,CAAGhC,WAAW,EAA5B,CAEA;AACA,cAAsCD,QAAQ,CAAC,KAAD,CAA9C,wCAAOkC,WAAP,eAAoBC,cAApB,eACA,gBAAoCtC,UAAU,CAACkB,YAAD,CAAe,CAC3DI,KAAK,CAAE,EADoD,CAE3DE,OAAO,CAAE,IAFkD,CAAf,CAA9C,4CAAOe,UAAP,iBAAmBC,aAAnB,iBAKA,iBAAkCxC,UAAU,CAAC6B,WAAD,CAAc,CACxDP,KAAK,CAAE,EADiD,CAExDE,OAAO,CAAE,IAF+C,CAAd,CAA5C,6CAAOiB,SAAP,iBAAkBC,YAAlB,iBAKA,iBAA0C1C,UAAU,CAAC0B,eAAD,CAAkB,CACpEJ,KAAK,CAAE,EAD6D,CAEpEE,OAAO,CAAE,IAF2D,CAAlB,CAApD,6CAAOmB,aAAP,iBAAsBC,gBAAtB,iBAKA,iBAA8C5C,UAAU,CAAC8B,iBAAD,CAAoB,CAC1ER,KAAK,CAAE,EADmE,CAE1EE,OAAO,CAAE,IAFiE,CAApB,CAAxD,6CAAOqB,eAAP,iBAAwBC,kBAAxB,iBAKA,iBAAsC9C,UAAU,CAAC+B,aAAD,CAAgB,CAC9DT,KAAK,CAAE,EADuD,CAE9DE,OAAO,CAAE,IAFqD,CAAhB,CAAhD,8CAAOuB,WAAP,kBAAoBC,cAApB,kBAKA,kBAAkChD,UAAU,CAACgC,WAAD,CAAc,CACxDV,KAAK,CAAE,EADiD,CAExDE,OAAO,CAAE,IAF+C,CAAd,CAA5C,+CAAOyB,SAAP,kBAAkBC,YAAlB,kBAKA;AACA,GAAMC,CAAAA,YAAY,CAAGlD,MAAM,EAA3B,CACA,GAAMmD,CAAAA,aAAa,CAAGnD,MAAM,EAA5B,CACA,GAAMoD,CAAAA,gBAAgB,CAAGpD,MAAM,EAA/B,CACA,GAAMqD,CAAAA,kBAAkB,CAAGrD,MAAM,EAAjC,CACA,GAAMsD,CAAAA,cAAc,CAAGtD,MAAM,EAA7B,CACA,GAAMuD,CAAAA,YAAY,CAAGvD,MAAM,EAA3B,CAEA,aAOIW,OAAO,EAPX,CACE6C,SADF,UACEA,SADF,CAEEC,KAFF,UAEEA,KAFF,CAGeC,eAHf,UAGEC,WAHF,CAIEC,QAJF,UAIEA,QAJF,CAKEC,UALF,UAKEA,UALF,CAMEC,aANF,UAMEA,aANF,CASA;AACA7D,SAAS,CACP,UAAY,CACV,GAAM8D,CAAAA,UAAU,CAAGC,UAAU,CAAC,UAAM,CAClC,GAAI/B,KAAK,CAACgC,UAAV,CAAsB,CACpB5B,cAAc,CACZG,SAAS,CAACjB,OAAV,EACEe,UAAU,CAACf,OADb,EAEEmB,aAAa,CAACnB,OAFhB,EAGEqB,eAAe,CAACrB,OAHlB,EAIEuB,WAAW,CAACvB,OAJd,EAKEyB,SAAS,CAACzB,OANA,CAAd,CAQD,CATD,IASO,CACLc,cAAc,CAACC,UAAU,CAACf,OAAX,EAAsBmB,aAAa,CAACnB,OAArC,CAAd,CACD,CACF,CAb4B,CAa1B,GAb0B,CAA7B,CAeA,MAAO,SAAS2C,CAAAA,UAAT,EAAsB,CAC3BC,YAAY,CAACJ,UAAD,CAAZ,CACD,CAFD,CAGD,CApBM,CAqBP;AACA;AACA,CACEvB,SAAS,CAACjB,OADZ,CAEEe,UAAU,CAACf,OAFb,CAGEmB,aAAa,CAACnB,OAHhB,CAIEqB,eAAe,CAACrB,OAJlB,CAKEuB,WAAW,CAACvB,OALd,CAMEyB,SAAS,CAACzB,OANZ,CAOEU,KAAK,CAACgC,UAPR,CAQE7B,WARF,CAvBO,CAAT,CAmCA;AAEA;AACA,GAAMgC,CAAAA,oBAAoB,0FAAG,iBAAOC,WAAP,kHAC3BX,eAAe,CAAC,CACdY,GAAG,CAAE,+CADS,CAEdC,MAAM,CAAE,MAFM,CAGdC,OAAO,CAAE,CACP,eAAgB,kBADT,CAHK,CAMdC,IAAI,CAAE,CACJC,IAAI,CAAEL,WAAW,CAACM,WADd,CAEJC,KAAK,CAAEP,WAAW,CAACQ,YAFf,CAGJC,QAAQ,CAAET,WAAW,CAACU,eAHlB,CAIJC,UAAU,CAAEX,WAAW,CAACY,iBAJpB,CAKJC,UAAU,CAAEb,WAAW,CAACc,aALpB,CAMJC,GAAG,CAAEf,WAAW,CAACgB,WANb,CAOJC,OAAO,CAAEjB,WAAW,CAACJ,UAPjB,CANQ,CAedsB,QAAQ,CAAE,iBAfI,CAAD,CAAf,CAD2B,sDAAH,kBAApBnB,CAAAA,oBAAoB,4CAA1B,CAoBA;AAEA,QAASoB,CAAAA,iBAAT,CAA2BC,KAA3B,CAAkC,CAChChD,YAAY,CAAC,CAAErB,IAAI,CAAE,YAAR,CAAsBE,GAAG,CAAEmE,KAAK,CAACC,MAAN,CAAarE,KAAxC,CAAD,CAAZ,CACD,CACD,QAASsE,CAAAA,mBAAT,EAA+B,CAC7BlD,YAAY,CAAC,CAAErB,IAAI,CAAE,YAAR,CAAD,CAAZ,CACD,CACD,QAASwE,CAAAA,kBAAT,CAA4BH,KAA5B,CAAmC,CACjClD,aAAa,CAAC,CAAEnB,IAAI,CAAE,YAAR,CAAsBE,GAAG,CAAEmE,KAAK,CAACC,MAAN,CAAarE,KAAxC,CAAD,CAAb,CACD,CACD,QAASwE,CAAAA,oBAAT,EAAgC,CAC9BtD,aAAa,CAAC,CAAEnB,IAAI,CAAE,YAAR,CAAD,CAAb,CACD,CACD,QAAS0E,CAAAA,qBAAT,CAA+BL,KAA/B,CAAsC,CACpC9C,gBAAgB,CAAC,CAAEvB,IAAI,CAAE,YAAR,CAAsBE,GAAG,CAAEmE,KAAK,CAACC,MAAN,CAAarE,KAAxC,CAAD,CAAhB,CACAL,eAAe,CAAGyE,KAAK,CAACC,MAAN,CAAarE,KAA/B,CACD,CACD,QAAS0E,CAAAA,uBAAT,EAAmC,CACjCpD,gBAAgB,CAAC,CAAEvB,IAAI,CAAE,YAAR,CAAD,CAAhB,CACD,CACD,QAAS4E,CAAAA,uBAAT,CAAiCP,KAAjC,CAAwC,CACtC5C,kBAAkB,CAAC,CAAEzB,IAAI,CAAE,YAAR,CAAsBE,GAAG,CAAEmE,KAAK,CAACC,MAAN,CAAarE,KAAxC,CAAD,CAAlB,CACD,CACD,QAAS4E,CAAAA,yBAAT,EAAqC,CACnCpD,kBAAkB,CAAC,CAAEzB,IAAI,CAAE,YAAR,CAAD,CAAlB,CACD,CACD,QAAS8E,CAAAA,mBAAT,CAA6BT,KAA7B,CAAoC,CAClC1C,cAAc,CAAC,CAAE3B,IAAI,CAAE,YAAR,CAAsBE,GAAG,CAAEmE,KAAK,CAACC,MAAN,CAAarE,KAAxC,CAAD,CAAd,CACD,CACD,QAAS8E,CAAAA,qBAAT,EAAiC,CAC/BpD,cAAc,CAAC,CAAE3B,IAAI,CAAE,YAAR,CAAD,CAAd,CACD,CACD,QAASgF,CAAAA,iBAAT,CAA2BX,KAA3B,CAAkC,CAChCxC,YAAY,CAAC,CAAE7B,IAAI,CAAE,YAAR,CAAsBE,GAAG,CAAEmE,KAAK,CAACC,MAAN,CAAarE,KAAxC,CAAD,CAAZ,CACD,CACD,QAASgF,CAAAA,mBAAT,EAA+B,CAC7BpD,YAAY,CAAC,CAAE7B,IAAI,CAAE,YAAR,CAAD,CAAZ,CACD,CAED;AAEA,QAASkF,CAAAA,aAAT,CAAuBb,KAAvB,CAA8B,CAC5BA,KAAK,CAACc,cAAN,GAEA,GAAItE,KAAK,CAACgC,UAAV,CAAsB,CACpB,GAAMU,CAAAA,WAAW,CAAGnC,SAAS,CAACnB,KAA9B,CACA,GAAMwD,CAAAA,YAAY,CAAGvC,UAAU,CAACjB,KAAhC,CACA,GAAM0D,CAAAA,eAAe,CAAGrC,aAAa,CAACrB,KAAtC,CACA,GAAM4D,CAAAA,iBAAiB,CAAGrC,eAAe,CAACvB,KAA1C,CACA,GAAM8D,CAAAA,aAAa,CAAGrC,WAAW,CAACzB,KAAlC,CACA,GAAMgE,CAAAA,WAAW,CAAGrC,SAAS,CAAC3B,KAA9B,CAEA,GAAIe,WAAJ,CAAiB,CACf,GAAMiC,CAAAA,WAAW,CAAG,CAClBM,WAAW,CAAXA,WADkB,CAElBE,YAAY,CAAZA,YAFkB,CAGlBE,eAAe,CAAfA,eAHkB,CAIlBE,iBAAiB,CAAjBA,iBAJkB,CAKlBE,aAAa,CAAbA,aALkB,CAMlBE,WAAW,CAAXA,WANkB,CAOlBpB,UAAU,CAAE,GAPM,CAApB,CAUAG,oBAAoB,CAACC,WAAD,CAApB,CACAhC,cAAc,CAAC,KAAD,CAAd,CACAJ,KAAK,CAACuE,UAAN,GACA/D,YAAY,CAAC,CAAErB,IAAI,CAAE,OAAR,CAAD,CAAZ,CACAmB,aAAa,CAAC,CAAEnB,IAAI,CAAE,OAAR,CAAD,CAAb,CACAuB,gBAAgB,CAAC,CAAEvB,IAAI,CAAE,OAAR,CAAD,CAAhB,CACAyB,kBAAkB,CAAC,CAAEzB,IAAI,CAAE,OAAR,CAAD,CAAlB,CACA2B,cAAc,CAAC,CAAE3B,IAAI,CAAE,OAAR,CAAD,CAAd,CACA6B,YAAY,CAAC,CAAE7B,IAAI,CAAE,OAAR,CAAD,CAAZ,CACD,CACF,CA7BD,IA6BO,CACL,GAAMyD,CAAAA,aAAY,CAAGvC,UAAU,CAACjB,KAAhC,CACA,GAAM0D,CAAAA,gBAAe,CAAGrC,aAAa,CAACrB,KAAtC,CAEA,GAAIe,WAAJ,CAAiB,CACf,GAAMiC,CAAAA,YAAW,CAAG,CAClBQ,YAAY,CAAZA,aADkB,CAElBE,eAAe,CAAfA,gBAFkB,CAGlBd,UAAU,CAAE,GAHM,CAApB,CAMAG,oBAAoB,CAACC,YAAD,CAApB,CACAhC,cAAc,CAAC,KAAD,CAAd,CACAE,aAAa,CAAC,CAAEnB,IAAI,CAAE,OAAR,CAAD,CAAb,CACAuB,gBAAgB,CAAC,CAAEvB,IAAI,CAAE,OAAR,CAAD,CAAhB,CACD,CACF,CACF,CACD,QAASqF,CAAAA,eAAT,EAA2B,CACzB5C,UAAU,GACVC,aAAa,GACd,CAED,GAAIF,QAAQ,CAAC8C,YAAT,GAA0B,CAA9B,CAAiC,CAC/BvE,QAAQ,CAAC9B,YAAY,CAACsG,iBAAb,EAAD,CAAR,CACAxE,QAAQ,CAAC9B,YAAY,CAACuG,YAAb,CAA0BhD,QAAQ,CAACiD,MAAnC,CAAD,CAAR,CACAC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAmC,CAAnC,EACAD,YAAY,CAACC,OAAb,CAAqB,QAArB,CAA+BnD,QAAQ,CAACiD,MAAxC,EACAJ,eAAe,GAChB,CAEDxG,SAAS,CAAC,UAAM,CACd,GAAIgC,KAAK,CAAC+E,MAAV,CAAkB,CAChB9E,QAAQ,CAAC,QAAD,CAAR,CACD,CACF,CAJQ,CAIN,CAACD,KAAK,CAAC+E,MAAP,CAAe9E,QAAf,CAJM,CAAT,CAMA;AAEA,GAAM+E,CAAAA,YAAY,cAChB,YAAK,SAAS,CAAEvG,OAAO,CAACwG,OAAxB,uBACE,KAAC,MAAD,EAAQ,SAAS,CAAExG,OAAO,CAACyG,GAA3B,CAAgC,OAAO,CAAEV,eAAzC,mBADF,EADF,CAQA,GAAMW,CAAAA,iBAAiB,cACrB,KAAC,KAAD,CAAO,QAAP,wBACE,YAAK,SAAS,CAAE1G,OAAO,CAAC2G,KAAxB,uBACE,sBAAOzD,QAAQ,CAAC0D,eAAhB,EADF,EADF,EADF,CAQA;AAEA,GAAI9D,SAAJ,CAAe,CACb,mBACE,YAAK,SAAS,CAAC,UAAf,uBACE,KAAC,cAAD,IADF,EADF,CAKD,CAED,mBACE,MAAC,IAAD,EAAM,SAAS,CAAE9C,OAAO,CAAC6G,KAAzB,WACG,CAAC9D,KAAK,EAAIG,QAAQ,CAAC8C,YAAT,GAA0Bc,SAApC,gBACC,MAAC,KAAD,EAAO,OAAO,CAAEvF,KAAK,CAACwF,OAAtB,WACGL,iBADH,CAEGH,YAFH,GAFJ,cAOE,cAAM,QAAQ,CAAEX,aAAhB,WACGrE,KAAK,CAACgC,UAAN,eACC,KAAC,KAAD,EACE,GAAG,CAAEf,YADP,CAEE,EAAE,CAAC,MAFL,CAGE,KAAK,CAAC,MAHR,CAIE,IAAI,CAAC,MAJP,CAKE,OAAO,CAAEV,SAAS,CAACjB,OALrB,CAME,KAAK,CAAEiB,SAAS,CAACnB,KANnB,CAOE,QAAQ,CAAEmE,iBAPZ,CAQE,MAAM,CAAEG,mBARV,EAFJ,cAaE,KAAC,KAAD,EACE,GAAG,CAAExC,aADP,CAEE,EAAE,CAAC,OAFL,CAGE,KAAK,CAAC,QAHR,CAIE,IAAI,CAAC,OAJP,CAKE,OAAO,CAAEb,UAAU,CAACf,OALtB,CAME,KAAK,CAAEe,UAAU,CAACjB,KANpB,CAOE,QAAQ,CAAEuE,kBAPZ,CAQE,MAAM,CAAEC,oBARV,EAbF,cAuBE,KAAC,KAAD,EACE,GAAG,CAAEzC,gBADP,CAEE,EAAE,CAAC,UAFL,CAGE,KAAK,CAAC,UAHR,CAIE,IAAI,CAAC,UAJP,CAKE,OAAO,CAAEV,aAAa,CAACnB,OALzB,CAME,KAAK,CAAEmB,aAAa,CAACrB,KANvB,CAOE,QAAQ,CAAEyE,qBAPZ,CAQE,MAAM,CAAEC,uBARV,EAvBF,CAiCG9D,KAAK,CAACgC,UAAN,eACC,KAAC,KAAD,EACE,GAAG,CAAEZ,kBADP,CAEE,EAAE,CAAC,YAFL,CAGE,KAAK,CAAC,aAHR,CAIE,IAAI,CAAC,UAJP,CAKE,OAAO,CAAET,eAAe,CAACrB,OAL3B,CAME,KAAK,CAAEqB,eAAe,CAACvB,KANzB,CAOE,QAAQ,CAAE2E,uBAPZ,CAQE,MAAM,CAAEC,yBARV,EAlCJ,CA6CGhE,KAAK,CAACgC,UAAN,eACC,aAAK,SAAS,CAAExD,MAAM,CAACiH,OAAvB,wBACE,sCADF,cAEE,gBACE,GAAG,CAAEpE,cADP,CAEE,SAAS,CAAE5C,OAAO,CAACiH,MAFrB,CAGE,IAAI,CAAC,YAHP,CAIE,EAAE,CAAC,SAJL,CAKE,KAAK,CAAE7E,WAAW,CAACzB,KALrB,CAME,QAAQ,CAAE6E,mBANZ,CAOE,MAAM,CAAEC,qBAPV,wBASE,eAAQ,KAAK,CAAC,EAAd,CAAiB,KAAK,CAAE,CAAEyB,KAAK,CAAE,MAAT,CAAxB,8BATF,cAYE,eAAQ,KAAK,CAAC,OAAd,CAAsB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA7B,mBAZF,cAeE,eAAQ,KAAK,CAAC,MAAd,CAAqB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA5B,kBAfF,cAkBE,eAAQ,KAAK,CAAC,MAAd,CAAqB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA5B,kBAlBF,cAqBE,eAAQ,KAAK,CAAC,OAAd,CAAsB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA7B,mBArBF,cAwBE,eAAQ,KAAK,CAAC,QAAd,CAAuB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA9B,oBAxBF,cA2BE,eAAQ,KAAK,CAAC,OAAd,CAAsB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA7B,mBA3BF,cA8BE,eAAQ,KAAK,CAAC,OAAd,CAAsB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA7B,mBA9BF,cAiCE,eAAQ,KAAK,CAAC,KAAd,CAAoB,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAA3B,iBAjCF,cAoCE,eAAQ,KAAK,CAAC,aAAd,CAA4B,KAAK,CAAE,CAAEA,KAAK,CAAE,OAAT,CAAnC,yBApCF,GAFF,GA9CJ,CA0FG3F,KAAK,CAACgC,UAAN,eACC,aAAK,SAAS,CAAExD,MAAM,CAACiH,OAAvB,wBACE,cAAO,OAAO,CAAC,MAAf,2BADF,cAEE,cACE,GAAG,CAAEnE,YADP,CAEE,EAAE,CAAC,MAFL,CAGE,KAAK,CAAC,cAHR,CAIE,IAAI,CAAC,MAJP,CAKE,OAAO,CAAEP,SAAS,CAACzB,OALrB,CAME,KAAK,CAAEyB,SAAS,CAAC3B,KANnB,CAOE,QAAQ,CAAE+E,iBAPZ,CAQE,MAAM,CAAEC,mBARV,CASE,GAAG,CAAEtF,MAAM,GAAG8G,MAAT,CAAgB,YAAhB,CATP,EAFF,GA3FJ,CA0GG,CAAC5F,KAAK,CAACgC,UAAP,eACC,aAAK,SAAS,CAAEvD,OAAO,CAACS,MAAxB,wBACE,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAET,OAAO,CAACyG,GAAzC,qBADF,cAIE,KAAC,MAAD,IAJF,GA3GJ,CAkHGlF,KAAK,CAACgC,UAAN,eACC,aAAK,SAAS,CAAEvD,OAAO,CAACS,MAAxB,wBACE,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAET,OAAO,CAACyG,GAAzC,qBADF,cAIE,KAAC,MAAD,IAJF,GAnHJ,GAPF,GADF,CAqID,CAED,cAAenF,CAAAA,KAAf","sourcesContent":["import React, { useReducer, useRef, useEffect, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Outlet } from \"react-router-dom\";\r\nimport { loginActions } from \"../../store/login-slice\";\r\nimport Card from \"../UI/Card/Card\";\r\nimport Button from \"../UI/Button/Button\";\r\nimport Input from \"../CommonInput/Input\";\r\nimport styles from \"../CommonInput/Input.module.css\";\r\nimport classes from \"./Login.module.css\";\r\nimport useHttp from \"../../hooks/use-http\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport LoadingSpinner from \"../UI/LoadingSpinner\";\r\nimport Modal from \"../UI/Modal\";\r\nimport moment from \"moment\";\r\n\r\nvar currentPassword = \"\";\r\n\r\n//************REDUCERS************//\r\n\r\nfunction emailReducer(state, action) {\r\n  if (action.type === \"USER_INPUT\") {\r\n    return { value: action.val, isValid: action.val.includes(\"@\") };\r\n  }\r\n  if (action.type === \"INPUT_BLUR\") {\r\n    return { value: state.value, isValid: state.value.includes(\"@\") };\r\n  }\r\n  if (action.type === \"CLEAR\") {\r\n    return { value: \"\", isValid: null };\r\n  }\r\n\r\n  return { value: \"\", isValid: false };\r\n}\r\n\r\nfunction passwordReducer(state, action) {\r\n  if (action.type === \"USER_INPUT\") {\r\n    return { value: action.val, isValid: action.val.trim().length > 6 };\r\n  }\r\n  if (action.type === \"INPUT_BLUR\") {\r\n    return { value: state.value, isValid: state.value.trim().length > 6 };\r\n  }\r\n  if (action.type === \"CLEAR\") {\r\n    return { value: \"\", isValid: null };\r\n  }\r\n\r\n  return { value: \"\", isValid: false };\r\n}\r\n\r\nfunction nameReducer(state, action) {\r\n  if (action.type === \"USER_INPUT\") {\r\n    return { value: action.val, isValid: action.val.trim().length !== \"\" };\r\n  }\r\n  if (action.type === \"INPUT_BLUR\") {\r\n    return { value: state.value, isValid: state.value.trim().length !== \"\" };\r\n  }\r\n  if (action.type === \"CLEAR\") {\r\n    return { value: \"\", isValid: null };\r\n  }\r\n\r\n  return { value: \"\", isValid: false };\r\n}\r\n\r\nfunction rePasswordReducer(state, action) {\r\n  if (action.type === \"USER_INPUT\") {\r\n    return {\r\n      value: action.val,\r\n      isValid: action.val.trim() === currentPassword.trim(),\r\n    };\r\n  }\r\n  if (action.type === \"INPUT_BLUR\") {\r\n    return {\r\n      value: state.value,\r\n      isValid: state.value.trim() === currentPassword.trim(),\r\n    };\r\n  }\r\n  if (action.type === \"CLEAR\") {\r\n    return { value: \"\", isValid: null };\r\n  }\r\n\r\n  return { value: \"\", isValid: false };\r\n}\r\n\r\nfunction planetReducer(state, action) {\r\n  if (action.type === \"USER_INPUT\") {\r\n    return { value: action.val, isValid: action.val.trim() !== \"\" };\r\n  }\r\n  if (action.type === \"INPUT_BLUR\") {\r\n    return {\r\n      value: state.value,\r\n      isValid: state.value.trim() !== \"\",\r\n    };\r\n  }\r\n  if (action.type === \"CLEAR\") {\r\n    return { value: \"\", isValid: null };\r\n  }\r\n  return { value: \"\", isValid: false };\r\n}\r\n\r\nfunction dateReducer(state, action) {\r\n  if (action.type === \"USER_INPUT\") {\r\n    return { value: action.val, isValid: action.val.trim() !== \"\" };\r\n  }\r\n  if (action.type === \"INPUT_BLUR\") {\r\n    return {\r\n      value: state.value,\r\n      isValid: state.value.trim() !== \"\",\r\n    };\r\n  }\r\n  if (action.type === \"CLEAR\") {\r\n    return { value: \"\", isValid: null };\r\n  }\r\n  return { value: \"\", isValid: false };\r\n}\r\n\r\nfunction Login(props) {\r\n  //************DECLARATIONS************//\r\n\r\n  const navigate = useNavigate();\r\n  const dispatch = useDispatch();\r\n\r\n  //STATES\r\n  const [formIsValid, setFormIsValid] = useState(false);\r\n  const [emailState, dispatchEmail] = useReducer(emailReducer, {\r\n    value: \"\",\r\n    isValid: null,\r\n  });\r\n\r\n  const [nameState, dispatchName] = useReducer(nameReducer, {\r\n    value: \"\",\r\n    isValid: null,\r\n  });\r\n\r\n  const [passwordState, dispatchPassword] = useReducer(passwordReducer, {\r\n    value: \"\",\r\n    isValid: null,\r\n  });\r\n\r\n  const [rePasswordState, dispatchRePassword] = useReducer(rePasswordReducer, {\r\n    value: \"\",\r\n    isValid: null,\r\n  });\r\n\r\n  const [planetState, dispatchPlanet] = useReducer(planetReducer, {\r\n    value: \"\",\r\n    isValid: null,\r\n  });\r\n\r\n  const [dateState, dispatchDate] = useReducer(dateReducer, {\r\n    value: \"\",\r\n    isValid: null,\r\n  });\r\n\r\n  //REFS\r\n  const nameInputRef = useRef();\r\n  const emailInputRef = useRef();\r\n  const passwordInputRef = useRef();\r\n  const rePasswordInputRef = useRef();\r\n  const planetInputRef = useRef();\r\n  const dateInputRef = useRef();\r\n\r\n  const {\r\n    isLoading,\r\n    error,\r\n    sendRequest: sendTaskRequest,\r\n    response,\r\n    resetError,\r\n    resetResponse,\r\n  } = useHttp();\r\n\r\n  //checking for form validity every 500ms\r\n  useEffect(\r\n    function () {\r\n      const identifier = setTimeout(() => {\r\n        if (props.signUpFlag) {\r\n          setFormIsValid(\r\n            nameState.isValid &&\r\n              emailState.isValid &&\r\n              passwordState.isValid &&\r\n              rePasswordState.isValid &&\r\n              planetState.isValid &&\r\n              dateState.isValid\r\n          );\r\n        } else {\r\n          setFormIsValid(emailState.isValid && passwordState.isValid);\r\n        }\r\n      }, 200);\r\n\r\n      return function clearTimer() {\r\n        clearTimeout(identifier);\r\n      };\r\n    },\r\n    //use effect dependencies - will re run every time below dependencies change.\r\n    //Therefore useffect is guaranteed to use the latest state.\r\n    [\r\n      nameState.isValid,\r\n      emailState.isValid,\r\n      passwordState.isValid,\r\n      rePasswordState.isValid,\r\n      planetState.isValid,\r\n      dateState.isValid,\r\n      props.signUpFlag,\r\n      formIsValid,\r\n    ]\r\n  );\r\n\r\n  //************API CALLS************//\r\n\r\n  //Request to backend for login and sign-up\r\n  const SignUpRequestHandler = async (requestJson) => {\r\n    sendTaskRequest({\r\n      url: \"http://localhost:8080/api/protected/loginAuth\",\r\n      method: \"post\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: {\r\n        name: requestJson.enteredName,\r\n        email: requestJson.enteredEmail,\r\n        password: requestJson.enteredPassword,\r\n        rePassword: requestJson.enteredRePassword,\r\n        basePlanet: requestJson.enteredPlanet,\r\n        dob: requestJson.enteredDate,\r\n        signUpF: requestJson.signUpFlag,\r\n      },\r\n      errorMsg: \"Request failed!\",\r\n    });\r\n  };\r\n\r\n  //************STATE HANDLERS************//\r\n\r\n  function nameChangeHandler(event) {\r\n    dispatchName({ type: \"USER_INPUT\", val: event.target.value });\r\n  }\r\n  function validateNameHandler() {\r\n    dispatchName({ type: \"INPUT_BLUR\" });\r\n  }\r\n  function emailChangeHandler(event) {\r\n    dispatchEmail({ type: \"USER_INPUT\", val: event.target.value });\r\n  }\r\n  function validateEmailHandler() {\r\n    dispatchEmail({ type: \"INPUT_BLUR\" });\r\n  }\r\n  function passwordChangeHandler(event) {\r\n    dispatchPassword({ type: \"USER_INPUT\", val: event.target.value });\r\n    currentPassword = event.target.value;\r\n  }\r\n  function validatePasswordHandler() {\r\n    dispatchPassword({ type: \"INPUT_BLUR\" });\r\n  }\r\n  function rePasswordChangeHandler(event) {\r\n    dispatchRePassword({ type: \"USER_INPUT\", val: event.target.value });\r\n  }\r\n  function validateRePasswordHandler() {\r\n    dispatchRePassword({ type: \"INPUT_BLUR\" });\r\n  }\r\n  function planetChangeHandler(event) {\r\n    dispatchPlanet({ type: \"USER_INPUT\", val: event.target.value });\r\n  }\r\n  function validatePlanetHandler() {\r\n    dispatchPlanet({ type: \"INPUT_BLUR\" });\r\n  }\r\n  function dateChangeHandler(event) {\r\n    dispatchDate({ type: \"USER_INPUT\", val: event.target.value });\r\n  }\r\n  function validateDateHandler() {\r\n    dispatchDate({ type: \"INPUT_BLUR\" });\r\n  }\r\n\r\n  //************ACTION HANDLERS************//\r\n\r\n  function submitHandler(event) {\r\n    event.preventDefault();\r\n\r\n    if (props.signUpFlag) {\r\n      const enteredName = nameState.value;\r\n      const enteredEmail = emailState.value;\r\n      const enteredPassword = passwordState.value;\r\n      const enteredRePassword = rePasswordState.value;\r\n      const enteredPlanet = planetState.value;\r\n      const enteredDate = dateState.value;\r\n\r\n      if (formIsValid) {\r\n        const requestJson = {\r\n          enteredName,\r\n          enteredEmail,\r\n          enteredPassword,\r\n          enteredRePassword,\r\n          enteredPlanet,\r\n          enteredDate,\r\n          signUpFlag: \"Y\",\r\n        };\r\n\r\n        SignUpRequestHandler(requestJson);\r\n        setFormIsValid(false);\r\n        props.postSignUp();\r\n        dispatchName({ type: \"CLEAR\" });\r\n        dispatchEmail({ type: \"CLEAR\" });\r\n        dispatchPassword({ type: \"CLEAR\" });\r\n        dispatchRePassword({ type: \"CLEAR\" });\r\n        dispatchPlanet({ type: \"CLEAR\" });\r\n        dispatchDate({ type: \"CLEAR\" });\r\n      }\r\n    } else {\r\n      const enteredEmail = emailState.value;\r\n      const enteredPassword = passwordState.value;\r\n\r\n      if (formIsValid) {\r\n        const requestJson = {\r\n          enteredEmail,\r\n          enteredPassword,\r\n          signUpFlag: \"N\",\r\n        };\r\n\r\n        SignUpRequestHandler(requestJson);\r\n        setFormIsValid(false);\r\n        dispatchEmail({ type: \"CLEAR\" });\r\n        dispatchPassword({ type: \"CLEAR\" });\r\n      }\r\n    }\r\n  }\r\n  function closeErrorModal() {\r\n    resetError();\r\n    resetResponse();\r\n  }\r\n\r\n  if (response.responseCode === 0) {\r\n    dispatch(loginActions.LoginStateHandler());\r\n    dispatch(loginActions.UpdateUserId(response.userId));\r\n    localStorage.setItem(\"isLoggedIn\", 1);\r\n    localStorage.setItem(\"userId\", response.userId);\r\n    closeErrorModal();\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (props.loginF) {\r\n      navigate(\"/login\");\r\n    }\r\n  }, [props.loginF, navigate]);\r\n\r\n  //************MODALS************//\r\n\r\n  const modalActions = (\r\n    <div className={classes.actions}>\r\n      <Button className={classes.btn} onClick={closeErrorModal}>\r\n        Close\r\n      </Button>\r\n    </div>\r\n  );\r\n\r\n  const loginModalContent = (\r\n    <React.Fragment>\r\n      <div className={classes.total}>\r\n        <span>{response.responseMessage}</span>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n  //************LOADING SPINNERS************//\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"centered\">\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Card className={classes.login}>\r\n      {(error || response.responseCode !== undefined) && (\r\n        <Modal onClose={props.onClose}>\r\n          {loginModalContent}\r\n          {modalActions}\r\n        </Modal>\r\n      )}\r\n      <form onSubmit={submitHandler}>\r\n        {props.signUpFlag && (\r\n          <Input\r\n            ref={nameInputRef}\r\n            id=\"name\"\r\n            label=\"Name\"\r\n            type=\"text\"\r\n            isValid={nameState.isValid}\r\n            value={nameState.value}\r\n            onChange={nameChangeHandler}\r\n            onBlur={validateNameHandler}\r\n          />\r\n        )}\r\n        <Input\r\n          ref={emailInputRef}\r\n          id=\"email\"\r\n          label=\"E-Mail\"\r\n          type=\"email\"\r\n          isValid={emailState.isValid}\r\n          value={emailState.value}\r\n          onChange={emailChangeHandler}\r\n          onBlur={validateEmailHandler}\r\n        />\r\n        <Input\r\n          ref={passwordInputRef}\r\n          id=\"password\"\r\n          label=\"Password\"\r\n          type=\"password\"\r\n          isValid={passwordState.isValid}\r\n          value={passwordState.value}\r\n          onChange={passwordChangeHandler}\r\n          onBlur={validatePasswordHandler}\r\n        />\r\n        {props.signUpFlag && (\r\n          <Input\r\n            ref={rePasswordInputRef}\r\n            id=\"rePassword\"\r\n            label=\"Re-Password\"\r\n            type=\"password\"\r\n            isValid={rePasswordState.isValid}\r\n            value={rePasswordState.value}\r\n            onChange={rePasswordChangeHandler}\r\n            onBlur={validateRePasswordHandler}\r\n          />\r\n        )}\r\n        {props.signUpFlag && (\r\n          <div className={styles.control}>\r\n            <label>Base Planet</label>\r\n            <select\r\n              ref={planetInputRef}\r\n              className={classes.select}\r\n              name=\"planetList\"\r\n              id=\"planets\"\r\n              value={planetState.value}\r\n              onChange={planetChangeHandler}\r\n              onBlur={validatePlanetHandler}\r\n            >\r\n              <option value=\"\" style={{ color: \"grey\" }}>\r\n                Select an Option\r\n              </option>\r\n              <option value=\"Earth\" style={{ color: \"black\" }}>\r\n                Earth\r\n              </option>\r\n              <option value=\"Mars\" style={{ color: \"black\" }}>\r\n                Mars\r\n              </option>\r\n              <option value=\"Moon\" style={{ color: \"black\" }}>\r\n                Moon\r\n              </option>\r\n              <option value=\"Ceres\" style={{ color: \"black\" }}>\r\n                Ceres\r\n              </option>\r\n              <option value=\"Europa\" style={{ color: \"black\" }}>\r\n                Europa\r\n              </option>\r\n              <option value=\"Titan\" style={{ color: \"black\" }}>\r\n                Titan\r\n              </option>\r\n              <option value=\"EB-15\" style={{ color: \"black\" }}>\r\n                EB-15\r\n              </option>\r\n              <option value=\"ISS\" style={{ color: \"black\" }}>\r\n                ISS\r\n              </option>\r\n              <option value=\"Kepler-186F\" style={{ color: \"black\" }}>\r\n                Kepler-186F\r\n              </option>\r\n            </select>\r\n          </div>\r\n        )}\r\n        {props.signUpFlag && (\r\n          <div className={styles.control}>\r\n            <label htmlFor=\"date\">Date of Birth</label>\r\n            <input\r\n              ref={dateInputRef}\r\n              id=\"date\"\r\n              label=\"Journey Date\"\r\n              type=\"date\"\r\n              isValid={dateState.isValid}\r\n              value={dateState.value}\r\n              onChange={dateChangeHandler}\r\n              onBlur={validateDateHandler}\r\n              max={moment().format(\"YYYY-MM-DD\")}\r\n            ></input>\r\n          </div>\r\n        )}\r\n        {!props.signUpFlag && (\r\n          <div className={classes.action}>\r\n            <Button type=\"submit\" className={classes.btn}>\r\n              Sign in\r\n            </Button>\r\n            <Outlet />\r\n          </div>\r\n        )}\r\n        {props.signUpFlag && (\r\n          <div className={classes.action}>\r\n            <Button type=\"submit\" className={classes.btn}>\r\n              Sign up\r\n            </Button>\r\n            <Outlet />\r\n          </div>\r\n        )}\r\n      </form>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}