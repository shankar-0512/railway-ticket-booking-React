{"ast":null,"code":"import _asyncToGenerator from\"D:/React JS/space-ticket-booking-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/React JS/space-ticket-booking-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\React JS\\\\space-ticket-booking-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useRef}from\"react\";import{useParams}from\"react-router-dom\";import classes from\"../Profile/MyProfile.module.css\";import loginStyles from\"../Authentication/Login.module.css\";import Input from\"../CommonInput/Input\";import Button from\"../UI/Button/Button\";import Layout from\"../layout/Layout\";import{useNavigate}from\"react-router-dom\";import styles from\"../Home/Home.module.css\";import useHttp from\"../../hooks/use-http\";import LoadingSpinner from\"../UI/LoadingSpinner\";import Modal from\"../UI/Modal\";import{useSelector}from\"react-redux\";//************GLOBAL VARIABLES************//\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var form1IsValid=false;var form2IsValid=false;var formIsValid=false;var otpRetries=3;function Booking(){//************DECLARATIONS************//\nvar navigate=useNavigate();var userId=localStorage.getItem(\"userId\");var params=useParams();var shipId=params.shipId;var boardingStation=useSelector(function(state){return state.user.from;});var arrivalStation=useSelector(function(state){return state.user.to;});var shipClass=useSelector(function(state){return state.user.class;});var journeyDate=useSelector(function(state){return state.user.journeyDate;});var _useHttp=useHttp(),verifyIsLoading=_useHttp.isLoading,verifyError=_useHttp.error,sendVerifyRequest=_useHttp.sendRequest,verifyResponse=_useHttp.response,resetVerifyError=_useHttp.resetError,resetVerifyResponse=_useHttp.resetResponse;var _useHttp2=useHttp(),otpIsLoading=_useHttp2.isLoading,otpError=_useHttp2.error,sendOtpRequest=_useHttp2.sendRequest,otpResponse=_useHttp2.response,resetOtpError=_useHttp2.resetError,resetOtpResponse=_useHttp2.resetResponse;var _useHttp3=useHttp(),ticketIsLoading=_useHttp3.isLoading,ticketError=_useHttp3.error,sendGenerateRequest=_useHttp3.sendRequest,ticketResponse=_useHttp3.response,resetTicketError=_useHttp3.resetError,resetTicketResponse=_useHttp3.resetResponse;//REFS\nvar nameInputRef=useRef();var ageInputRef=useRef();var emailInputRef=useRef();var phoneInputRef=useRef();var name2InputRef=useRef();var age2InputRef=useRef();var otpInputRef=useRef();//STATES\nvar _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),userName=_useState2[0],setUserName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),age=_useState4[0],setAge=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),email=_useState6[0],setEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),phoneNumber=_useState8[0],setPhoneNumber=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),user2Name=_useState10[0],setUser2Name=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),age2=_useState12[0],setAge2=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),otp=_useState14[0],setOtp=_useState14[1];var _useState15=useState(1),_useState16=_slicedToArray(_useState15,2),passengerCount=_useState16[0],setPassengerCount=_useState16[1];var _useState17=useState({userNameIsValid:true,ageIsValid:true,emailIsValid:true,phoneNumberIsValid:true,user2NameIsValid:true,age2IsValid:true}),_useState18=_slicedToArray(_useState17,2),formInputsValidity=_useState18[0],setFormInputsValidity=_useState18[1];//STATE HANDLERS\nfunction nameChangeHandler(event){setUserName(event.target.value);}function ageChangeHandler(event){setAge(event.target.value);}function emailChangeHandler(event){setEmail(event.target.value);}function phoneNumberChangeHandler(event){setPhoneNumber(event.target.value);}function name2ChangeHandler(event){setUser2Name(event.target.value);}function age2ChangeHandler(event){setAge2(event.target.value);}function otpChangeHandler(event){setOtp(event.target.value);}//************API CALLS************//\n//Request to backend for verification email\nvar EmailVerification=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(requestJson){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:sendVerifyRequest({url:\"http://localhost:8080/api/protected/verifyUser\",method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:{userEmail:requestJson.email},errorMsg:\"Request failed!\"});case 1:case\"end\":return _context.stop();}}},_callee);}));return function EmailVerification(_x){return _ref.apply(this,arguments);};}();//Request to backend for checking OTP\nvar OTPVerification=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(requestJson){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:sendOtpRequest({url:\"http://localhost:8080/api/protected/verifyOtp\",method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:{otp:requestJson.otp,userEmail:requestJson.email,deleteFlag:requestJson.deleteFlag},errorMsg:\"Request failed!\"});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function OTPVerification(_x2){return _ref2.apply(this,arguments);};}();//Request to backend for generating E-Ticket\nvar generateETicket=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(requestJson){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:sendGenerateRequest({url:\"http://localhost:8080/api/protected/generateEticket\",method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:{userName:requestJson.userName,user2Name:requestJson.user2Name,userEmail:requestJson.email,userAge:requestJson.age,user2Age:requestJson.age2,shipId:requestJson.shipId,shipClass:requestJson.shipClass,boardingStation:requestJson.boardingStation,arrivalStation:requestJson.arrivalStation,journeyDate:requestJson.journeyDate,userId:requestJson.userId},errorMsg:\"Request failed!\"});case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function generateETicket(_x3){return _ref3.apply(this,arguments);};}();//************ACTION HANDLERS************//\nfunction onClickCancelHandler(){navigate(\"/home\");}function onClickAddPassenger(){setPassengerCount(passengerCount+1);console.log(formInputsValidity.user2NameIsValid);console.log(formInputsValidity.userNameIsValid);}function bookingSubmitHandler(event){event.preventDefault();var userNameValidity=userName.trim()!==\"\";var ageValidity=age.trim()>0;var emailValidity=email.trim().includes(\"@\");var phoneValidity=phoneNumber.trim()!==\"\";setFormInputsValidity({userNameIsValid:userNameValidity,ageIsValid:ageValidity,emailIsValid:emailValidity,phoneNumberIsValid:phoneValidity});form1IsValid=userNameValidity&&ageValidity&&emailValidity&&phoneValidity;formIsValid=form1IsValid;if(passengerCount===2){var user2Validity=user2Name.trim()!==\"\";var age2Validity=age2.trim()>0;setFormInputsValidity({userNameIsValid:userNameValidity,ageIsValid:ageValidity,emailIsValid:emailValidity,phoneNumberIsValid:phoneValidity,user2NameIsValid:user2Validity,age2IsValid:age2Validity});form2IsValid=userNameValidity&&ageValidity&&emailValidity&&phoneValidity&&user2Validity&&age2Validity;formIsValid=form1IsValid&&form2IsValid;}if(formIsValid){setFormInputsValidity({userNameIsValid:true,ageIsValid:true,emailIsValid:true,phoneNumberIsValid:true,user2NameIsValid:true,age2IsValid:true});var requestJson={email:email};EmailVerification(requestJson);}}function otpSubmitHandler(event){event.preventDefault();var requestJson={otp:otp,email:email};OTPVerification(requestJson);otpRetries=otpRetries-1;}function closeTicketErrorModal(){resetTicketResponse();navigate(\"/home\");}function resetOtp(){resetOtpError();resetOtpResponse();}function retryOtpErrorModal(){resetOtp();}function closeOtpErrorModal(){resetOtp();otpRetries=3;closeTicketErrorModal();var requestJson={email:email,deleteFlag:\"Y\"};OTPVerification(requestJson);}if(otpResponse.responseCode===0){var requestJson={userName:userName,user2Name:user2Name,email:email,age:age,age2:age2,shipId:shipId,shipClass:shipClass,boardingStation:boardingStation,arrivalStation:arrivalStation,journeyDate:journeyDate,userId:userId};generateETicket(requestJson);resetOtpResponse();resetVerifyError();resetVerifyResponse();}var ticketModalActions=/*#__PURE__*/_jsx(\"div\",{className:classes.actions,children:/*#__PURE__*/_jsx(Button,{className:classes.btn,onClick:closeTicketErrorModal,children:\"Okay\"})});var otpModalActions=/*#__PURE__*/_jsxs(\"div\",{className:classes.actions,children:[otpRetries!==0&&/*#__PURE__*/_jsxs(Button,{className:classes.btn,onClick:retryOtpErrorModal,children:[\"Retry(\",otpRetries,\")\"]}),otpRetries===0&&/*#__PURE__*/_jsx(Button,{className:classes.btn,onClick:closeOtpErrorModal,children:\"Close\"})]});//************MODALS************//\nvar ticketModalContent=/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:classes.total,children:/*#__PURE__*/_jsx(\"span\",{children:ticketResponse.responseMessage})})});var otpFailureModalContent=/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:classes.total,children:/*#__PURE__*/_jsx(\"span\",{children:otpResponse.responseMessage})})});var BookingModalContent=/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:classes.total,children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:otpSubmitHandler,children:[/*#__PURE__*/_jsx(Input,{ref:otpInputRef,id:\"otp\",label:\"Please enter your OTP :\",type:\"number\",value:otp,onChange:otpChangeHandler}),/*#__PURE__*/_jsx(Button,{className:classes.btn,type:\"submit\",children:\"Submit\"})]})})});//************LOADING SPINNERS************//\nif(verifyIsLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"centered\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Please wait, Sending verification mail...\"}),/*#__PURE__*/_jsx(LoadingSpinner,{})]});}if(otpIsLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"centered\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Verifying...\"}),/*#__PURE__*/_jsx(LoadingSpinner,{})]});}if(ticketIsLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"centered\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Making your Reservation, please do not leave this page...\"}),/*#__PURE__*/_jsx(LoadingSpinner,{})]});}return/*#__PURE__*/_jsxs(Layout,{children:[(verifyError||verifyResponse.responseCode===0&&otpResponse.responseCode!==1)&&/*#__PURE__*/_jsx(Modal,{onClose:null,children:BookingModalContent}),(ticketError||ticketResponse.responseCode===0)&&/*#__PURE__*/_jsxs(Modal,{onClose:null,children:[ticketModalContent,ticketModalActions]}),(otpError||otpResponse.responseCode===1)&&/*#__PURE__*/_jsxs(Modal,{onClose:null,children:[otpFailureModalContent,otpModalActions]}),/*#__PURE__*/_jsx(\"section\",{className:styles.summary,children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:bookingSubmitHandler,children:[/*#__PURE__*/_jsx(\"h3\",{className:classes.h2,children:\"Passenger 1 - Details\"}),!formInputsValidity.userNameIsValid&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:\"Please enter your Name.\"}),/*#__PURE__*/_jsx(Input,{ref:nameInputRef,id:\"name1\",label:\"Name\",type:\"text\",value:userName,onChange:nameChangeHandler}),!formInputsValidity.ageIsValid&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:\"Please enter your Age.\"}),/*#__PURE__*/_jsx(Input,{ref:ageInputRef,id:\"age1\",label:\"Age\",type:\"number\",value:age,onChange:ageChangeHandler}),!formInputsValidity.emailIsValid&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:\"Please enter your Email.\"}),/*#__PURE__*/_jsx(Input,{ref:emailInputRef,id:\"email\",label:\"Email\",type:\"text\",value:email,onChange:emailChangeHandler}),!formInputsValidity.phoneNumberIsValid&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:\"Please enter your Mobile Number.\"}),/*#__PURE__*/_jsx(Input,{ref:phoneInputRef,id:\"phoneNumber\",label:\"Mobile\",type:\"number\",value:phoneNumber,onChange:phoneNumberChangeHandler}),passengerCount===2&&/*#__PURE__*/_jsx(\"h3\",{className:classes.h2,children:\"Passenger 2 - Details\"}),passengerCount===2&&!formInputsValidity.user2NameIsValid&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:\"Please enter your Name.\"}),passengerCount===2&&/*#__PURE__*/_jsx(Input,{ref:name2InputRef,id:\"name2\",label:\"Name\",type:\"text\",value:user2Name,onChange:name2ChangeHandler}),passengerCount===2&&!formInputsValidity.age2IsValid&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:\"Please enter your Age.\"}),passengerCount===2&&/*#__PURE__*/_jsx(Input,{ref:age2InputRef,id:\"age2\",label:\"Age\",type:\"number\",value:age2,onChange:age2ChangeHandler}),/*#__PURE__*/_jsxs(\"div\",{className:loginStyles.action,children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",className:classes.btn,children:\"Book\"}),passengerCount<2&&/*#__PURE__*/_jsx(Button,{type:\"button\",className:classes.btn,onClick:onClickAddPassenger,children:\"Add Passenger\"}),/*#__PURE__*/_jsx(Button,{type:\"button\",className:classes.btn,onClick:onClickCancelHandler,children:\"Cancel\"})]})]})})]});}export default Booking;","map":{"version":3,"sources":["D:/React JS/space-ticket-booking-app/src/components/Ticket Booking/Booking.js"],"names":["React","useState","useRef","useParams","classes","loginStyles","Input","Button","Layout","useNavigate","styles","useHttp","LoadingSpinner","Modal","useSelector","form1IsValid","form2IsValid","formIsValid","otpRetries","Booking","navigate","userId","localStorage","getItem","params","shipId","boardingStation","state","user","from","arrivalStation","to","shipClass","class","journeyDate","verifyIsLoading","isLoading","verifyError","error","sendVerifyRequest","sendRequest","verifyResponse","response","resetVerifyError","resetError","resetVerifyResponse","resetResponse","otpIsLoading","otpError","sendOtpRequest","otpResponse","resetOtpError","resetOtpResponse","ticketIsLoading","ticketError","sendGenerateRequest","ticketResponse","resetTicketError","resetTicketResponse","nameInputRef","ageInputRef","emailInputRef","phoneInputRef","name2InputRef","age2InputRef","otpInputRef","userName","setUserName","age","setAge","email","setEmail","phoneNumber","setPhoneNumber","user2Name","setUser2Name","age2","setAge2","otp","setOtp","passengerCount","setPassengerCount","userNameIsValid","ageIsValid","emailIsValid","phoneNumberIsValid","user2NameIsValid","age2IsValid","formInputsValidity","setFormInputsValidity","nameChangeHandler","event","target","value","ageChangeHandler","emailChangeHandler","phoneNumberChangeHandler","name2ChangeHandler","age2ChangeHandler","otpChangeHandler","EmailVerification","requestJson","url","method","headers","body","userEmail","errorMsg","OTPVerification","deleteFlag","generateETicket","userAge","user2Age","onClickCancelHandler","onClickAddPassenger","console","log","bookingSubmitHandler","preventDefault","userNameValidity","trim","ageValidity","emailValidity","includes","phoneValidity","user2Validity","age2Validity","otpSubmitHandler","closeTicketErrorModal","resetOtp","retryOtpErrorModal","closeOtpErrorModal","responseCode","ticketModalActions","actions","btn","otpModalActions","ticketModalContent","total","responseMessage","otpFailureModalContent","BookingModalContent","summary","h2","action"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport classes from \"../Profile/MyProfile.module.css\";\r\nimport loginStyles from \"../Authentication/Login.module.css\";\r\nimport Input from \"../CommonInput/Input\";\r\nimport Button from \"../UI/Button/Button\";\r\nimport Layout from \"../layout/Layout\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport styles from \"../Home/Home.module.css\";\r\nimport useHttp from \"../../hooks/use-http\";\r\nimport LoadingSpinner from \"../UI/LoadingSpinner\";\r\nimport Modal from \"../UI/Modal\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\n//************GLOBAL VARIABLES************//\r\n\r\nvar form1IsValid = false;\r\nvar form2IsValid = false;\r\nvar formIsValid = false;\r\nvar otpRetries = 3;\r\n\r\nfunction Booking() {\r\n  //************DECLARATIONS************//\r\n\r\n  const navigate = useNavigate();\r\n  const userId = localStorage.getItem(\"userId\");\r\n\r\n  const params = useParams();\r\n  const { shipId } = params;\r\n\r\n  const boardingStation = useSelector((state) => state.user.from);\r\n  const arrivalStation = useSelector((state) => state.user.to);\r\n  const shipClass = useSelector((state) => state.user.class);\r\n  const journeyDate = useSelector((state) => state.user.journeyDate);\r\n\r\n  const {\r\n    isLoading: verifyIsLoading,\r\n    error: verifyError,\r\n    sendRequest: sendVerifyRequest,\r\n    response: verifyResponse,\r\n    resetError: resetVerifyError,\r\n    resetResponse: resetVerifyResponse,\r\n  } = useHttp();\r\n\r\n  const {\r\n    isLoading: otpIsLoading,\r\n    error: otpError,\r\n    sendRequest: sendOtpRequest,\r\n    response: otpResponse,\r\n    resetError: resetOtpError,\r\n    resetResponse: resetOtpResponse,\r\n  } = useHttp();\r\n\r\n  const {\r\n    isLoading: ticketIsLoading,\r\n    error: ticketError,\r\n    sendRequest: sendGenerateRequest,\r\n    response: ticketResponse,\r\n    resetError: resetTicketError,\r\n    resetResponse: resetTicketResponse,\r\n  } = useHttp();\r\n\r\n  //REFS\r\n  const nameInputRef = useRef();\r\n  const ageInputRef = useRef();\r\n  const emailInputRef = useRef();\r\n  const phoneInputRef = useRef();\r\n  const name2InputRef = useRef();\r\n  const age2InputRef = useRef();\r\n  const otpInputRef = useRef();\r\n\r\n  //STATES\r\n  const [userName, setUserName] = useState(\"\");\r\n  const [age, setAge] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [user2Name, setUser2Name] = useState(\"\");\r\n  const [age2, setAge2] = useState(\"\");\r\n  const [otp, setOtp] = useState(\"\");\r\n  const [passengerCount, setPassengerCount] = useState(1);\r\n  const [formInputsValidity, setFormInputsValidity] = useState({\r\n    userNameIsValid: true,\r\n    ageIsValid: true,\r\n    emailIsValid: true,\r\n    phoneNumberIsValid: true,\r\n    user2NameIsValid: true,\r\n    age2IsValid: true,\r\n  });\r\n\r\n  //STATE HANDLERS\r\n  function nameChangeHandler(event) {\r\n    setUserName(event.target.value);\r\n  }\r\n  function ageChangeHandler(event) {\r\n    setAge(event.target.value);\r\n  }\r\n  function emailChangeHandler(event) {\r\n    setEmail(event.target.value);\r\n  }\r\n  function phoneNumberChangeHandler(event) {\r\n    setPhoneNumber(event.target.value);\r\n  }\r\n  function name2ChangeHandler(event) {\r\n    setUser2Name(event.target.value);\r\n  }\r\n  function age2ChangeHandler(event) {\r\n    setAge2(event.target.value);\r\n  }\r\n  function otpChangeHandler(event) {\r\n    setOtp(event.target.value);\r\n  }\r\n\r\n  //************API CALLS************//\r\n\r\n  //Request to backend for verification email\r\n  const EmailVerification = async (requestJson) => {\r\n    sendVerifyRequest({\r\n      url: \"http://localhost:8080/api/protected/verifyUser\",\r\n      method: \"post\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: {\r\n        userEmail: requestJson.email,\r\n      },\r\n      errorMsg: \"Request failed!\",\r\n    });\r\n  };\r\n\r\n  //Request to backend for checking OTP\r\n  const OTPVerification = async (requestJson) => {\r\n    sendOtpRequest({\r\n      url: \"http://localhost:8080/api/protected/verifyOtp\",\r\n      method: \"post\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: {\r\n        otp: requestJson.otp,\r\n        userEmail: requestJson.email,\r\n        deleteFlag: requestJson.deleteFlag,\r\n      },\r\n      errorMsg: \"Request failed!\",\r\n    });\r\n  };\r\n\r\n  //Request to backend for generating E-Ticket\r\n  const generateETicket = async (requestJson) => {\r\n    sendGenerateRequest({\r\n      url: \"http://localhost:8080/api/protected/generateEticket\",\r\n      method: \"post\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: {\r\n        userName: requestJson.userName,\r\n        user2Name: requestJson.user2Name,\r\n        userEmail: requestJson.email,\r\n        userAge: requestJson.age,\r\n        user2Age: requestJson.age2,\r\n        shipId: requestJson.shipId,\r\n        shipClass: requestJson.shipClass,\r\n        boardingStation: requestJson.boardingStation,\r\n        arrivalStation: requestJson.arrivalStation,\r\n        journeyDate: requestJson.journeyDate,\r\n        userId: requestJson.userId,\r\n      },\r\n      errorMsg: \"Request failed!\",\r\n    });\r\n  };\r\n\r\n  //************ACTION HANDLERS************//\r\n\r\n  function onClickCancelHandler() {\r\n    navigate(\"/home\");\r\n  }\r\n\r\n  function onClickAddPassenger() {\r\n    setPassengerCount(passengerCount + 1);\r\n    console.log(formInputsValidity.user2NameIsValid);\r\n    console.log(formInputsValidity.userNameIsValid);\r\n  }\r\n\r\n  function bookingSubmitHandler(event) {\r\n    event.preventDefault();\r\n\r\n    const userNameValidity = userName.trim() !== \"\";\r\n    const ageValidity = age.trim() > 0;\r\n    const emailValidity = email.trim().includes(\"@\");\r\n    const phoneValidity = phoneNumber.trim() !== \"\";\r\n\r\n    setFormInputsValidity({\r\n      userNameIsValid: userNameValidity,\r\n      ageIsValid: ageValidity,\r\n      emailIsValid: emailValidity,\r\n      phoneNumberIsValid: phoneValidity,\r\n    });\r\n\r\n    form1IsValid =\r\n      userNameValidity && ageValidity && emailValidity && phoneValidity;\r\n\r\n    formIsValid = form1IsValid;\r\n\r\n    if (passengerCount === 2) {\r\n      const user2Validity = user2Name.trim() !== \"\";\r\n      const age2Validity = age2.trim() > 0;\r\n\r\n      setFormInputsValidity({\r\n        userNameIsValid: userNameValidity,\r\n        ageIsValid: ageValidity,\r\n        emailIsValid: emailValidity,\r\n        phoneNumberIsValid: phoneValidity,\r\n        user2NameIsValid: user2Validity,\r\n        age2IsValid: age2Validity,\r\n      });\r\n\r\n      form2IsValid =\r\n        userNameValidity &&\r\n        ageValidity &&\r\n        emailValidity &&\r\n        phoneValidity &&\r\n        user2Validity &&\r\n        age2Validity;\r\n\r\n      formIsValid = form1IsValid && form2IsValid;\r\n    }\r\n\r\n    if (formIsValid) {\r\n      setFormInputsValidity({\r\n        userNameIsValid: true,\r\n        ageIsValid: true,\r\n        emailIsValid: true,\r\n        phoneNumberIsValid: true,\r\n        user2NameIsValid: true,\r\n        age2IsValid: true,\r\n      });\r\n\r\n      const requestJson = { email };\r\n      EmailVerification(requestJson);\r\n    }\r\n  }\r\n\r\n  function otpSubmitHandler(event) {\r\n    event.preventDefault();\r\n\r\n    const requestJson = { otp, email };\r\n    OTPVerification(requestJson);\r\n    otpRetries = otpRetries - 1;\r\n  }\r\n\r\n  function closeTicketErrorModal() {\r\n    resetTicketResponse();\r\n    navigate(\"/home\");\r\n  }\r\n\r\n  function resetOtp() {\r\n    resetOtpError();\r\n    resetOtpResponse();\r\n  }\r\n\r\n  function retryOtpErrorModal() {\r\n    resetOtp();\r\n  }\r\n\r\n  function closeOtpErrorModal() {\r\n    resetOtp();\r\n    otpRetries = 3;\r\n    closeTicketErrorModal();\r\n    const requestJson = {\r\n      email,\r\n      deleteFlag: \"Y\",\r\n    };\r\n    OTPVerification(requestJson);\r\n  }\r\n\r\n  if (otpResponse.responseCode === 0) {\r\n    const requestJson = {\r\n      userName,\r\n      user2Name,\r\n      email,\r\n      age,\r\n      age2,\r\n      shipId,\r\n      shipClass,\r\n      boardingStation,\r\n      arrivalStation,\r\n      journeyDate,\r\n      userId,\r\n    };\r\n\r\n    generateETicket(requestJson);\r\n    resetOtpResponse();\r\n    resetVerifyError();\r\n    resetVerifyResponse();\r\n  }\r\n\r\n  const ticketModalActions = (\r\n    <div className={classes.actions}>\r\n      <Button className={classes.btn} onClick={closeTicketErrorModal}>\r\n        Okay\r\n      </Button>\r\n    </div>\r\n  );\r\n\r\n  const otpModalActions = (\r\n    <div className={classes.actions}>\r\n      {otpRetries !== 0 && (\r\n        <Button className={classes.btn} onClick={retryOtpErrorModal}>\r\n          Retry({otpRetries})\r\n        </Button>\r\n      )}\r\n      {otpRetries === 0 && (\r\n        <Button className={classes.btn} onClick={closeOtpErrorModal}>\r\n          Close\r\n        </Button>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  //************MODALS************//\r\n\r\n  const ticketModalContent = (\r\n    <React.Fragment>\r\n      <div className={classes.total}>\r\n        <span>{ticketResponse.responseMessage}</span>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n  const otpFailureModalContent = (\r\n    <React.Fragment>\r\n      <div className={classes.total}>\r\n        <span>{otpResponse.responseMessage}</span>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n  const BookingModalContent = (\r\n    <React.Fragment>\r\n      <div className={classes.total}>\r\n        <form onSubmit={otpSubmitHandler}>\r\n          <Input\r\n            ref={otpInputRef}\r\n            id=\"otp\"\r\n            label=\"Please enter your OTP :\"\r\n            type=\"number\"\r\n            value={otp}\r\n            onChange={otpChangeHandler}\r\n          />\r\n          <Button className={classes.btn} type=\"submit\">\r\n            Submit\r\n          </Button>\r\n        </form>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n\r\n  //************LOADING SPINNERS************//\r\n\r\n  if (verifyIsLoading) {\r\n    return (\r\n      <div className=\"centered\">\r\n        <h2>Please wait, Sending verification mail...</h2>\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (otpIsLoading) {\r\n    return (\r\n      <div className=\"centered\">\r\n        <h2>Verifying...</h2>\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (ticketIsLoading) {\r\n    return (\r\n      <div className=\"centered\">\r\n        <h2>Making your Reservation, please do not leave this page...</h2>\r\n        <LoadingSpinner />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout>\r\n      {(verifyError ||\r\n        (verifyResponse.responseCode === 0 &&\r\n          otpResponse.responseCode !== 1)) && (\r\n        <Modal onClose={null}>{BookingModalContent}</Modal>\r\n      )}\r\n      {(ticketError || ticketResponse.responseCode === 0) && (\r\n        <Modal onClose={null}>\r\n          {ticketModalContent}\r\n          {ticketModalActions}\r\n        </Modal>\r\n      )}\r\n      {(otpError || otpResponse.responseCode === 1) && (\r\n        <Modal onClose={null}>\r\n          {otpFailureModalContent}\r\n          {otpModalActions}\r\n        </Modal>\r\n      )}\r\n      <section className={styles.summary}>\r\n        <form onSubmit={bookingSubmitHandler}>\r\n          <h3 className={classes.h2}>Passenger 1 - Details</h3>\r\n          {!formInputsValidity.userNameIsValid && (\r\n            <p className={styles.error}>Please enter your Name.</p>\r\n          )}\r\n          <Input\r\n            ref={nameInputRef}\r\n            id=\"name1\"\r\n            label=\"Name\"\r\n            type=\"text\"\r\n            value={userName}\r\n            onChange={nameChangeHandler}\r\n          />\r\n          {!formInputsValidity.ageIsValid && (\r\n            <p className={styles.error}>Please enter your Age.</p>\r\n          )}\r\n          <Input\r\n            ref={ageInputRef}\r\n            id=\"age1\"\r\n            label=\"Age\"\r\n            type=\"number\"\r\n            value={age}\r\n            onChange={ageChangeHandler}\r\n          />\r\n          {!formInputsValidity.emailIsValid && (\r\n            <p className={styles.error}>Please enter your Email.</p>\r\n          )}\r\n          <Input\r\n            ref={emailInputRef}\r\n            id=\"email\"\r\n            label=\"Email\"\r\n            type=\"text\"\r\n            value={email}\r\n            onChange={emailChangeHandler}\r\n          />\r\n          {!formInputsValidity.phoneNumberIsValid && (\r\n            <p className={styles.error}>Please enter your Mobile Number.</p>\r\n          )}\r\n          <Input\r\n            ref={phoneInputRef}\r\n            id=\"phoneNumber\"\r\n            label=\"Mobile\"\r\n            type=\"number\"\r\n            value={phoneNumber}\r\n            onChange={phoneNumberChangeHandler}\r\n          />\r\n          {passengerCount === 2 && (\r\n            <h3 className={classes.h2}>Passenger 2 - Details</h3>\r\n          )}\r\n\r\n          {passengerCount === 2 && !formInputsValidity.user2NameIsValid && (\r\n            <p className={styles.error}>Please enter your Name.</p>\r\n          )}\r\n          {passengerCount === 2 && (\r\n            <Input\r\n              ref={name2InputRef}\r\n              id=\"name2\"\r\n              label=\"Name\"\r\n              type=\"text\"\r\n              value={user2Name}\r\n              onChange={name2ChangeHandler}\r\n            />\r\n          )}\r\n          {passengerCount === 2 && !formInputsValidity.age2IsValid && (\r\n            <p className={styles.error}>Please enter your Age.</p>\r\n          )}\r\n          {passengerCount === 2 && (\r\n            <Input\r\n              ref={age2InputRef}\r\n              id=\"age2\"\r\n              label=\"Age\"\r\n              type=\"number\"\r\n              value={age2}\r\n              onChange={age2ChangeHandler}\r\n            />\r\n          )}\r\n          <div className={loginStyles.action}>\r\n            <Button type=\"submit\" className={classes.btn}>\r\n              Book\r\n            </Button>\r\n            {passengerCount < 2 && (\r\n              <Button\r\n                type=\"button\"\r\n                className={classes.btn}\r\n                onClick={onClickAddPassenger}\r\n              >\r\n                Add Passenger\r\n              </Button>\r\n            )}\r\n            <Button\r\n              type=\"button\"\r\n              className={classes.btn}\r\n              onClick={onClickCancelHandler}\r\n            >\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </section>\r\n    </Layout>\r\n  );\r\n}\r\nexport default Booking;\r\n"]},"metadata":{},"sourceType":"module"}